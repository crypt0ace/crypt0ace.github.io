<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Crypt0ace" /><meta property="og:locale" content="en" /><meta name="description" content="A blog for some cybersecurity stuff including write ups and red team shenanigans." /><meta property="og:description" content="A blog for some cybersecurity stuff including write ups and red team shenanigans." /><link rel="canonical" href="https://crypt0ace.github.io/" /><meta property="og:url" content="https://crypt0ace.github.io/" /><meta property="og:site_name" content="Crypt0ace" /><meta property="og:type" content="website" /><link rel="next" href="https://crypt0ace.github.io/page2" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Crypt0ace" /><meta name="twitter:site" content="@crypt0acee" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebSite","description":"A blog for some cybersecurity stuff including write ups and red team shenanigans.","headline":"Crypt0ace","name":"Ahmed Sher","sameAs":["https://twitter.com/crypt0acee","https://github.com/crypt0ace","https://www.linkedin.com/in/ahmed-sher-93234a206/"],"url":"https://crypt0ace.github.io/"}</script><title>Crypt0ace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Crypt0ace"><meta name="application-name" content="Crypt0ace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Crypt0ace</a></div><div class="site-subtitle font-italic">A Cybersecurity Blog by Ahmed Sher</div></div><ul class="w-100"><li class="nav-item active"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/crypt0ace" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/crypt0acee" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ahmedsherfreelance','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/ahmed-sher-93234a206/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span>Home</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Crypt0ace</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><div id="post-list"><div class="post-preview"><h1> <a href="/posts/NHA-Part-4/">AD Pwnage: Ninja Hackers Academy Part 4</a></h1><div class="post-content"><p> Introduction At this point, we have the domain. But we need to find any trust relationships that this domain has and if any, we need to move to that domain. Enumerating Trusts We can check the tru...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1711738800" data-df="ll" > Mar 30, 2024 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/NHA-Part-3/">AD Pwnage: Ninja Hackers Academy Part 3</a></h1><div class="post-content"><p> Introduction In the previous one, we pivoted from one machine to another using the GenericAll privileges over a container and then using RBCD to successfully generate a ticket that gave us the keys...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1707073200" data-df="ll" > Feb 5, 2024 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/NHA-Part-2/">AD Pwnage: Ninja Hackers Academy Part 2</a></h1><div class="post-content"><p> Introduction In the previous one, we went from a scope of subnet to initial access using an SQL injection and also escalated our privileges to SYSTEM to get more access. This time, we are going to ...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1705777200" data-df="ll" > Jan 21, 2024 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/NHA-Part-1/">AD Pwnage: Ninja Hackers Academy Part 1</a></h1><div class="post-content"><p> Introduction In these series of posts we are going to look into an AD lab called Ninja Hackers Academy (NHA) which can be found here. This is part of some great Active Directory labs from OrangeCyb...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1705086000" data-df="ll" > Jan 13, 2024 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/">Using D/Invoke for Offensive Tool Development in C#</a></h1><div class="post-content"><p> Introduction: In this post we are going to have a look into the D/Invoke project by TheWover. He also wrote a really good blog post which you can read here where he demonstrates in detail how the w...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1664564400" data-df="ll" > Oct 1, 2022 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Staying-under-the-Radar-Part-3/">Staying Under the Radar - Part 3 - Unhooking DLLs</a></h1><div class="post-content"><p> Introduction In this post we will look into how we can manually unhook DLLs that are attached by the EDRs. We can do this by swiping out the hooked version of ntdll.dll, the DLL to which all the fu...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1663959600" data-df="ll" > Sep 24, 2022 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Staying-under-the-Radar-Part-2/">Staying Under the Radar - Part 2 - Hiding IAT using Delegates</a></h1><div class="post-content"><p> Introduction In this post we are going to loo kat another technique we can use in C# that can help us keep our imports hidden and the Import Address Table (IAT) clean. This is done by the use of de...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1663614000" data-df="ll" > Sep 20, 2022 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Staying-under-the-Radar/">Staying Under the Radar - Part 1 - PPID Spoofing and Blocking DLLs</a></h1><div class="post-content"><p> Introduction In this post we are going to look at two “features” (lol) that Microsoft provided which can allow us to spoof our parent process ID and also block third party DLLs that are not Microso...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1663441200" data-df="ll" > Sep 18, 2022 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Shellcode-Injection-Techniques-Part-3/">Shellcode Injection in C# - Part 3 - QueueUserAPC | EarlyBird</a></h1><div class="post-content"><p> Introduction In this post we are going to look at another method for shellcode execution. THis involves using the API call QueueUserAPC. Like previous Process Hollowing, in this we are going to ope...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1663268400" data-df="ll" > Sep 16, 2022 </em></div></div></div><div class="post-preview"><h1> <a href="/posts/Shellcode-Injection-Techniques-Part-2/">Shellcode Injection in C# - Part 2 - Process Hollowing</a></h1><div class="post-content"><p> Introduction This post is part 2 of shellcode injection techniques. You can read part 1 here. In this one, we will look into Process Hollowing in C#. Process Hollowing Process Hollowing is a techn...</p></div><div class="post-meta text-muted d-flex"><div class="mr-auto"> <i class="far fa-calendar fa-fw"></i> <em class="" data-ts="1662663600" data-df="ll" > Sep 9, 2022 </em></div></div></div></div><ul class="pagination align-items-center mt-4 mb-5 pl-lg-2"><li class="page-item disabled"> <a class="page-link btn-box-shadow" href="#" aria-label="previous-page"> <i class="fas fa-angle-left"></i> </a><li class="page-item active"> <a class="page-link btn-box-shadow" href="/">1</a><li class="page-item "> <a class="page-link btn-box-shadow" href="/page2">2</a><li class="page-item "> <a class="page-link btn-box-shadow" href="/page3">3</a><li class="page-index align-middle"> <span>1</span> <span class="text-muted">/ 3</span><li class="page-item "> <a class="page-link btn-box-shadow" href="/page2" aria-label="next-page"> <i class="fas fa-angle-right"></i> </a></ul></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/NHA-Part-3/">AD Pwnage: Ninja Hackers Academy Part 3</a><li><a href="/posts/NHA-Part-2/">AD Pwnage: Ninja Hackers Academy Part 2</a><li><a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/">Using D/Invoke for Offensive Tool Development in C#</a><li><a href="/posts/Staying-under-the-Radar-Part-2/">Staying Under the Radar - Part 2 - Hiding IAT using Delegates</a><li><a href="/posts/Shellcode-Injection-Techniques/">Shellcode Injection in C# - Part 1 - Process Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/crypt0acee">Ahmed Sher</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/home.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
