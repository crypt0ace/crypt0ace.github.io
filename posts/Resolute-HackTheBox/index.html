<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Resolute - HackTheBox Walkthrough" /><meta name="author" content="crypt0ace" /><meta property="og:locale" content="en" /><meta name="description" content="Resolute - A medium diffficulty box with active directory" /><meta property="og:description" content="Resolute - A medium diffficulty box with active directory" /><link rel="canonical" href="https://crypt0ace.github.io/posts/Resolute-HackTheBox/" /><meta property="og:url" content="https://crypt0ace.github.io/posts/Resolute-HackTheBox/" /><meta property="og:site_name" content="Crypt0ace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-23T00:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Resolute - HackTheBox Walkthrough" /><meta name="twitter:site" content="@crypt0acee" /><meta name="twitter:creator" content="@crypt0ace" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"crypt0ace"},"dateModified":"2022-03-23T00:00:00+05:00","datePublished":"2022-03-23T00:00:00+05:00","description":"Resolute - A medium diffficulty box with active directory","headline":"Resolute - HackTheBox Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"https://crypt0ace.github.io/posts/Resolute-HackTheBox/"},"url":"https://crypt0ace.github.io/posts/Resolute-HackTheBox/"}</script><title>Resolute - HackTheBox Walkthrough | Crypt0ace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Crypt0ace"><meta name="application-name" content="Crypt0ace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Crypt0ace</a></div><div class="site-subtitle font-italic">A Cybersecurity Blog by Ahmed Sher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/crypt0ace" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/crypt0acee" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ahmedsherfreelance','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/ahmed-sher-93234a206/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Resolute - HackTheBox Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Resolute - HackTheBox Walkthrough</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1647975600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 23, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Ahmed Sher </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="546 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>Hello again. Today I will be looking into a medium box based on active directory from HackTheBox made by <a href="https://twitter.com/egre55">egre55</a>. <br /> This box starts with an easy foothold. The password is retrieved from RPC which gives us initial access. Then we move over to ryan user which is a part of DNS Admins group that has a priv esc route. Lets get into it.</p><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Nmap scan shows a lot of ports open. But the noteable ones are, DNS, WinRM, LDAP, And a bunch of RPC ports showing that it may be a domain controller. For a full port scan list you can refer to <a href="https://github.com/crypt0ace/Write-Ups/blob/main/HTB/resolute/allports.nmap">this</a>. <br /> So first lets enumerate LDAP and see if we can leak some information about the machine.</p><p><img data-src="/assets/img/resolute-hackthebox/ldapsearch.png" alt="LdapSearch" data-proofer-ignore></p><p>It outputs a lot of information but the important one is that it gives us a domain name. We can add it to our /etc/hosts file. I tried looking for other domain names but no luck. <br /> Now we can enumerate RPC and see if that leaks any information.</p><p><img data-src="/assets/img/resolute-hackthebox/rpcclient.png" alt="RPCClient" data-proofer-ignore></p><p>And it works! We have a list of users we can save. We can look at the groups too.</p><p><img data-src="/assets/img/resolute-hackthebox/groups.png" alt="Groups" data-proofer-ignore></p><p>We see all the normal ones except the “Contractors” group. Lets see whose part of that group.</p><p><img data-src="/assets/img/resolute-hackthebox/contractors.png" alt="Contractors" data-proofer-ignore></p><p>We see it only has one member Ryan Bertrand. Its good to keep it in the back of your head. <br /> Now another thing we can do is display decription of user accounts. Maybe they contain passwords? Lets see.</p><p><img data-src="/assets/img/resolute-hackthebox/display.png" alt="Display" data-proofer-ignore></p><p>And we do have it! We can use the list of users and this password to do password spraying and see it if actually gets us access into anything. I’ll use CrackMapExec for that.</p><p><img data-src="/assets/img/resolute-hackthebox/crackmapexec.png" alt="crackmapexec" data-proofer-ignore></p><p>Okay so after many errors we have one user. But it doesnt say pwned. Which means we can use something like psexec to get a shell in it. But we do have WinRM open on the box. We can try that using crackmapexec too.</p><p><img data-src="/assets/img/resolute-hackthebox/winrm.png" alt="winrm" data-proofer-ignore></p><p>We got it! We get the pwned sign which means we can get a shell now using Evil-WinRM</p><p><img data-src="/assets/img/resolute-hackthebox/initial.png" alt="initial" data-proofer-ignore></p><p>First thing we can look for is user.txt and retireive it. Lets look into users that have a home directory.</p><p><img data-src="/assets/img/resolute-hackthebox/users.png" alt="users" data-proofer-ignore></p><p>And we have ryan user. Which makes me wonder maybe we’re supposed to escalate to this user before actually getting root. After several rabbit holes I used the command that shows the hidden files in powershell. And I found a folder named PSTranscripts.</p><p><img data-src="/assets/img/resolute-hackthebox/hidden.png" alt="hidden" data-proofer-ignore></p><p>I used the WinRM’s download feature to get the powershell script I found.</p><p><img data-src="/assets/img/resolute-hackthebox/transcript.png" alt="transcript" data-proofer-ignore></p><p>And we find a password for ryan user.</p><p><img data-src="/assets/img/resolute-hackthebox/ryan_password.png" alt="Ryans Password" data-proofer-ignore></p><p>We can use it to get a shell using WinRM now.</p><p><img data-src="/assets/img/resolute-hackthebox/ryan.png" alt="Ryan" data-proofer-ignore></p><p>Now we can see the permissions and privileges the user Ryan has.</p><p><img data-src="/assets/img/resolute-hackthebox/dnsadmin.png" alt="DNS Admins" data-proofer-ignore></p><p>We have the user ryan in the DNS Admin group. Which can be vulnerable and is explained in this <a href="https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2">article</a>. So following the steps, we can try to escalate our priviliges to administrators. Making the malicious DLL and staring a SMB Server.</p><p><img data-src="/assets/img/resolute-hackthebox/server.png" alt="Server" data-proofer-ignore></p><p>Now we can inject the DLL and restart the service to see if we can get a shell back.</p><p><img data-src="/assets/img/resolute-hackthebox/root.png" alt="Root" data-proofer-ignore></p><p>And just like that we’re ROOT!! We can now get the root flag and submit it! <br /> If you have suggestions or if you wanna talk about anything. Contact me from the info in the footer. Till next time!</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/write-ups/" class="post-tag no-text-decoration" >Write-Ups</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Resolute+-+HackTheBox+Walkthrough+-+Crypt0ace&url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FResolute-HackTheBox%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Resolute+-+HackTheBox+Walkthrough+-+Crypt0ace&u=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FResolute-HackTheBox%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FResolute-HackTheBox%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/NHA-Part-3/">AD Pwnage: Ninja Hackers Academy Part 3</a><li><a href="/posts/NHA-Part-2/">AD Pwnage: Ninja Hackers Academy Part 2</a><li><a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/">Using D/Invoke for Offensive Tool Development in C#</a><li><a href="/posts/Staying-under-the-Radar-Part-2/">Staying Under the Radar - Part 2 - Hiding IAT using Delegates</a><li><a href="/posts/Shellcode-Injection-Techniques/">Shellcode Injection in C# - Part 1 - Process Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Panic-At-The-Disco-Stego/"><div class="card-body"> <em class="small" data-ts="1623524400" data-df="ll" > Jun 13, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Panic At The Disco - Stego Challenge</h3><div class="text-muted small"><p> Here we are given a simple png file. So as some of the first checks, I ran string on it strings PandeAtTheDisco.png And found what looks like a base64 encoded string: ZmxhZ3thcHBvbHNfYXJlX3Rhc...</p></div></div></a></div><div class="card"> <a href="/posts/Gift-HackMyVM-Walkthrough/"><div class="card-body"> <em class="small" data-ts="1626634800" data-df="ll" > Jul 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Gift - HackMyVM Walkthrough</h3><div class="text-muted small"><p> Gift is a really easy machine from HackMyVM created by sml. Perfect for beginners and the ones just started in the field. Here’s my write Up.. So we start off with an nmap scan, which i already ra...</p></div></div></a></div><div class="card"> <a href="/posts/LFI-TryHackMe/"><div class="card-body"> <em class="small" data-ts="1627498800" data-df="ll" > Jul 29, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Inclusion - TryHackMe</h3><div class="text-muted small"><p> This is a room best for beginners to understand and exploit LFI Vulnerabilty. If you want to follow along, You can join the room here, Inclusion Enumeration: First of all I ran the NMAP scan and ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Funbox-Part-4/" class="btn btn-outline-primary" prompt="Older"><p>Funbox Part 4</p></a> <a href="/posts/Dumping-Lsass/" class="btn btn-outline-primary" prompt="Newer"><p>Ways to Dump LSASS</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/crypt0acee">Ahmed Sher</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
