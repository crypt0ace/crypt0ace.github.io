<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Overpass 2 - Hacked" /><meta name="author" content="crypt0ace" /><meta property="og:locale" content="en" /><meta name="description" content="Overpass has been hacked! Can you analyse the attacker’s actions and hack back in?" /><meta property="og:description" content="Overpass has been hacked! Can you analyse the attacker’s actions and hack back in?" /><link rel="canonical" href="https://crypt0ace.github.io/posts/Overpass-2-TryHackMe/" /><meta property="og:url" content="https://crypt0ace.github.io/posts/Overpass-2-TryHackMe/" /><meta property="og:site_name" content="Crypt0ace" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-03T00:00:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Overpass 2 - Hacked" /><meta name="twitter:site" content="@crypt0acee" /><meta name="twitter:creator" content="@crypt0ace" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"crypt0ace"},"dateModified":"2021-08-03T00:00:00+05:00","datePublished":"2021-08-03T00:00:00+05:00","description":"Overpass has been hacked! Can you analyse the attacker’s actions and hack back in?","headline":"Overpass 2 - Hacked","mainEntityOfPage":{"@type":"WebPage","@id":"https://crypt0ace.github.io/posts/Overpass-2-TryHackMe/"},"url":"https://crypt0ace.github.io/posts/Overpass-2-TryHackMe/"}</script><title>Overpass 2 - Hacked | Crypt0ace</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Crypt0ace"><meta name="application-name" content="Crypt0ace"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Crypt0ace</a></div><div class="site-subtitle font-italic">A Cybersecurity Blog by Ahmed Sher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/crypt0ace" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/crypt0acee" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ahmedsherfreelance','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/ahmed-sher-93234a206/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Overpass 2 - Hacked</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Overpass 2 - Hacked</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1627930800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Ahmed Sher </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="885 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>This room is created by <a href="https://tryhackme.com/p/NinjaJc01">NinjaJc01</a> and focuses on PCAP Analysis and Forensics side. Here’s a link to the Room: <a href="https://tryhackme.com/room/overpass2hacked">Overpass 2 - Hacked</a>.</p><blockquote><p><b>Overpass has been hacked! The SOC team (Paradox, congratulations on the promotion) noticed suspicious activity on a late night shift while looking at shibes, and managed to capture packets as the attack happened. Can you work out how the attacker got in, and hack your way back into Overpass’ production server?</b></p></blockquote><p>So this hints what we would have to do. Analyze a PCAP and retrace the steps to get back in the server.</p><h2 id="analysis"><span class="mr-2">Analysis</span><a href="#analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>We start with a PCAP File. We can analyze this file using Wireshark Tool. Lets fire it up.</p><p><br /></p><p>The first question we get is:</p><blockquote><p><b>What was the URL of the page they used to upload a reverse shell?</b></p></blockquote><p>To see the URL to which the shell was uploaded we can see the requests made using this wireshark filter: <img data-src="/assets/img/overpass-2/wireshark-analysis.png" alt="Wireshark Analysis" data-proofer-ignore> <br /> With this we can see the requests made to the website and also where the shell was uploaded. <img data-src="/assets/img/overpass-2/request-analysis.png" alt="Requests Analysis" data-proofer-ignore> <br /> We will have the answer to our first question right here.</p><blockquote><p><b>What payload did the attacker use to gain access?</b></p></blockquote><p>This can also be found in the same filter. Look for a POST Request. And from there see at the data that was uploaded. You can see the payload that was used for initial access. <img data-src="/assets/img/overpass-2/payload.png" alt="Payload" data-proofer-ignore> <br /></p><blockquote><p><b> What password did the attacker use to privesc?</b></p></blockquote><p>To see more information on the pcap, We can look for <b> “tcp.eq.stream == 3” </b>. <img data-src="/assets/img/overpass-2/tcp-stream.png" alt="TCP Stream Filter" data-proofer-ignore> <br /> From here just do “Follow TCP Stream” or CTRL+SHIFT+ALT+T to follow the TCP Stream. You can see the password used by the attacker by analysing the TCP Stream. <img data-src="/assets/img/overpass-2/tcp-stream-follow.png" alt="Follow TCP Stream" data-proofer-ignore> <br /></p><blockquote><p><b>How did the attacker establish persistence?</b></p></blockquote><p>Using the same TCP Stream, We can find the backdoor that the attacker used and what the code is. <img data-src="/assets/img/overpass-2/backdoor.png" alt="Backdoor" data-proofer-ignore> <br /></p><blockquote><p><b>Using the fasttrack wordlist, how many of the system passwords were crackable? </b></p></blockquote><p>Just above this we can see that the attacker dumped the shadow file. We can see the hashes of 5 users. We can use John to crack these hashes from the fasttrack.txt wordlist as asked in the Task. <img data-src="/assets/img/overpass-2/hash.png" alt="Hashes" data-proofer-ignore> <br /></p><h2 id="research"><span class="mr-2">Research</span><a href="#research" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>In this section we are supposed to research the code that the attacker used to gain persistence on the server. We already have the link so we can just clone the repository on our local machine to research the code.</p><blockquote><p><b>What’s the default hash for the backdoor?</b></p></blockquote><p>We can open up sublime or any other text editor you prefer to read the code. GO Language is a programming language but you dont need to have programming knowledge to read the code and answer the questions. When we open it we can see the default hash right away. <img data-src="/assets/img/overpass-2/hashes.png" alt="Default Hash" data-proofer-ignore> <br /></p><blockquote><p><b>What’s the hardcoded salt for the backdoor?</b></p></blockquote><p>At the very end of this program, we can see the salt used for the backdoor. <img data-src="/assets/img/overpass-2/salt.png" alt="Salt" data-proofer-ignore> <br /></p><blockquote><p><b>What was the hash that the attacker used? - go back to the PCAP for this!</b></p></blockquote><p>To get the answer of this we need to go back to the PCAP File. Right where we left. At the part where the attacker set the persistence up. We can see what salt he used. <img data-src="/assets/img/overpass-2/attackers-salt.png" alt="Attckers-Salt" data-proofer-ignore> <br /></p><blockquote><p><b> Crack the hash using rockyou and a cracking tool of your choice. What’s the password?</b></p></blockquote><p>Okay sow let’s get cracking. We can use Hashcat to crack this hash. This is a SHA-512 hash. And we have the salt as well. So we will append the salt next to the hash so it appears liken this <b>”&lt; hash &gt;:&lt; salt &gt;”</b>. Now we can use Hashcat on it. I already ran it so I’m adding the <b>–show</b> tag in it as well. You dont need to use it. <img data-src="/assets/img/overpass-2/hashcat.png" alt="Hashcat" data-proofer-ignore> <br /></p><h2 id="attack"><span class="mr-2">Attack</span><a href="#attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>Okay so we have enough information now. We can use the information we gathered to get back in the server. Lets get to the tasks of this section.</p><blockquote><p><b>The attacker defaced the website. What message did they leave as a heading?</b></p></blockquote><p>Remember what we did in the Task 2? I did the same again and got a request to <b> “Index.HTML”</b>. In it we can see what the hacker wrote on the website. (Easy solution is to go to the address and see the website in browser ;) ) <img data-src="/assets/img/overpass-2/website.png" alt="Website Name" data-proofer-ignore> <br /></p><blockquote><p><b>Using the information you’ve found previously, hack your way back in!</b></p></blockquote><p>We know that the attacker uploaded a backdoor on SSH. We can use the sam eto get back in again. We already cracked the password used to setup the backdoor. Also a thing to note, when we see the hash in Task 1 of Section 2, we can see the port that is being used for the backdoor. Its on Port 2222. Lets get in the server. <img data-src="/assets/img/overpass-2/server.png" alt="Server" data-proofer-ignore> <br /></p><blockquote><p><b>What’s the user flag?</b></p></blockquote><p>And we’re in! Let us get the User Flag. <img data-src="/assets/img/overpass-2/user.png" alt="User.txt" data-proofer-ignore> <br /></p><blockquote><p><b>What’s the root flag?</b></p></blockquote><p>We can see a file using SUID Permissions in the user’s home directory. <img data-src="/assets/img/overpass-2/suid.png" alt="SUID File" data-proofer-ignore> <br /> Searching about it on GTFOBins, we can see this paaragraph that gives us a hint on how to exploit it. <img data-src="/assets/img/overpass-2/gtfobins.png" alt="GTFOBins" data-proofer-ignore> <br /> So we use this <b>“-p”</b> flag and see if we can get a root shell. <img data-src="/assets/img/overpass-2/root.png" alt="Root.txt" data-proofer-ignore> <br /> Aaand we’re ROOT! The machine is pwned. Submit the flags and get the points. Let me know if theres something you want to mention about the blog or anything in general. I’ll be happy to talk! :smile:</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/write-ups/" class="post-tag no-text-decoration" >Write-Ups</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Overpass+2+-+Hacked+-+Crypt0ace&url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FOverpass-2-TryHackMe%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Overpass+2+-+Hacked+-+Crypt0ace&u=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FOverpass-2-TryHackMe%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fcrypt0ace.github.io%2Fposts%2FOverpass-2-TryHackMe%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/NHA-Part-3/">AD Pwnage: Ninja Hackers Academy Part 3</a><li><a href="/posts/NHA-Part-2/">AD Pwnage: Ninja Hackers Academy Part 2</a><li><a href="/posts/Using-DInvoke-For-Offensive-Tool-Development/">Using D/Invoke for Offensive Tool Development in C#</a><li><a href="/posts/Staying-under-the-Radar-Part-2/">Staying Under the Radar - Part 2 - Hiding IAT using Delegates</a><li><a href="/posts/Shellcode-Injection-Techniques/">Shellcode Injection in C# - Part 1 - Process Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Panic-At-The-Disco-Stego/"><div class="card-body"> <em class="small" data-ts="1623524400" data-df="ll" > Jun 13, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Panic At The Disco - Stego Challenge</h3><div class="text-muted small"><p> Here we are given a simple png file. So as some of the first checks, I ran string on it strings PandeAtTheDisco.png And found what looks like a base64 encoded string: ZmxhZ3thcHBvbHNfYXJlX3Rhc...</p></div></div></a></div><div class="card"> <a href="/posts/Gift-HackMyVM-Walkthrough/"><div class="card-body"> <em class="small" data-ts="1626634800" data-df="ll" > Jul 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Gift - HackMyVM Walkthrough</h3><div class="text-muted small"><p> Gift is a really easy machine from HackMyVM created by sml. Perfect for beginners and the ones just started in the field. Here’s my write Up.. So we start off with an nmap scan, which i already ra...</p></div></div></a></div><div class="card"> <a href="/posts/LFI-TryHackMe/"><div class="card-body"> <em class="small" data-ts="1627498800" data-df="ll" > Jul 29, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Inclusion - TryHackMe</h3><div class="text-muted small"><p> This is a room best for beginners to understand and exploit LFI Vulnerabilty. If you want to follow along, You can join the room here, Inclusion Enumeration: First of all I ran the NMAP scan and ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/LFI-TryHackMe/" class="btn btn-outline-primary" prompt="Older"><p>Inclusion - TryHackMe</p></a> <a href="/posts/Funbox-Part-1/" class="btn btn-outline-primary" prompt="Newer"><p>Funbox Part 1</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/crypt0acee">Ahmed Sher</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/red-team/">Red Team</a> <a class="post-tag" href="/tags/write-ups/">Write-Ups</a> <a class="post-tag" href="/tags/funbox-series/">Funbox Series</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
